<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</title>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --info: #17a2b8;
            --dark: #2c3e50;
            --light: #ecf0f1;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light);
        }
        
        h1 {
            color: var(--dark);
            font-size: 2.2em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        
        .form-section {
            background: var(--light);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid var(--primary);
        }
        
        h2 {
            color: var(--dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        h2::before {
            content: "ğŸ“‹";
            font-size: 1.2em;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .required::after {
            content: " *";
            color: var(--danger);
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin: 8px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn-success { background: var(--secondary); }
        .btn-danger { background: var(--danger); }
        .btn-warning { background: var(--warning); }
        .btn-info { background: var(--info); }
        
        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }
        
        .message {
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
        }
        
        .success { 
            background: #d4edda; 
            color: #155724;
            border-left: 4px solid var(--secondary);
        }
        
        .error { 
            background: #f8d7da; 
            color: #721c24;
            border-left: 4px solid var(--danger);
        }
        
        #debugConsole {
            background: #1a1a1a;
            color: #00ff00;
            padding: 15px;
            margin-top: 30px;
            border-radius: 8px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            border: 2px solid #00ff00;
        }
        
        .debug-header {
            background: #004400;
            color: #00ff00;
            padding: 10px 15px;
            margin: -15px -15px 15px -15px;
            border-radius: 6px 6px 0 0;
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .debug-controls {
            display: flex;
            gap: 10px;
        }
        
        .debug-btn {
            background: #006600;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-online { background: var(--secondary); }
        .status-offline { background: var(--danger); }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .btn-group {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>âš¡ Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡</h1>
            <div class="subtitle">Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©</div>
        </header>
        
        <!-- Ù‚Ø³Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¯Ø§Ø¯ -->
        <div class="form-section">
            <h2>Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡</h2>
            
            <div class="form-group">
                <label for="meterNumber" class="required">Ø±Ù‚Ù… Ø§Ù„Ø¹Ø¯Ø§Ø¯</label>
                <input type="text" id="meterNumber" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø£Ùˆ Ø§Ù…Ø³Ø­ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯" value="TEST-001">
            </div>
            
            <div class="form-group">
                <label for="meterType" class="required">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯</label>
                <select id="meterType">
                    <option value="Ø°ÙƒÙ‰">Ø¹Ø¯Ø§Ø¯ Ø°ÙƒÙŠ</option>
                    <option value="Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙ‰">Ø¹Ø¯Ø§Ø¯ Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="meterBrand" class="required">Ù…Ø§Ø±ÙƒØ© Ø§Ù„Ø¹Ø¯Ø§Ø¯</label>
                <select id="meterBrand">
                    <option value="Ù‡ÙŠØ¯Ø±ÙˆØ³">Ù‡ÙŠØ¯Ø±ÙˆØ³</option>
                    <option value="Ø³Ù†Ø³ÙˆØ³">Ø³Ù†Ø³ÙˆØ³</option>
                    <option value="Ø§Ù†ØªØ¬Ø±Ø§">Ø§Ù†ØªØ¬Ø±Ø§</option>
                    <option value="wadad">Wadad</option>
                </select>
            </div>
        </div>
        
        <!-- Ù‚Ø³Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø¨Ø³ ÙˆØ§Ù„ØµÙ†Ø¯ÙˆÙ‚ -->
        <div class="form-section">
            <h2>Ø§Ù„Ù…Ø­Ø¨Ø³ ÙˆØ§Ù„ØµÙ†Ø¯ÙˆÙ‚</h2>
            
            <div class="form-group">
                <label for="valveType" class="required">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­Ø¨Ø³</label>
                <select id="valveType">
                    <option value="Ø¨ÙˆÙ‚Ø§ØªÙ‰">Ø¨ÙˆÙ‚Ø§ØªÙŠ</option>
                    <option value="Ø¹Ø§Ø¯Ù‰">Ø¹Ø§Ø¯ÙŠ</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="valveCondition" class="required">Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø­Ø¨Ø³</label>
                <select id="valveCondition">
                    <option value="Ø³Ù„ÙŠÙ…">Ø³Ù„ÙŠÙ…</option>
                    <option value="ÙŠØ­ØªØ§Ø¬ ØªØºÙŠÙŠØ±">ÙŠØ­ØªØ§Ø¬ ØªØºÙŠÙŠØ±</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="boxCondition" class="required">Ø­Ø§Ù„Ø© Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚</label>
                <select id="boxCondition">
                    <option value="Ø³Ù„ÙŠÙ…">Ø³Ù„ÙŠÙ…</option>
                    <option value="ÙŠØ­ØªØ§Ø¬ ØªØºÙŠÙŠØ±">ÙŠØ­ØªØ§Ø¬ ØªØºÙŠÙŠØ±</option>
                </select>
            </div>
        </div>
        
        <!-- Ù‚Ø³Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù‚Ø§Ø± -->
        <div class="form-section">
            <h2>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</h2>
            
            <div class="form-group">
                <label for="pieceNumber" class="required">Ø±Ù‚Ù… Ø§Ù„Ù‚Ø·Ø¹Ø©</label>
                <input type="text" id="pieceNumber" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©" value="Ù‚Ø·Ø¹Ø©-2024">
            </div>
            
            <div class="form-group">
                <label for="propertyType" class="required">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±</label>
                <select id="propertyType">
                    <option value="Ø³ÙƒÙ†Ù‰">Ø³ÙƒÙ†ÙŠ</option>
                    <option value="ØªØ¬Ø§Ø±Ù‰">ØªØ¬Ø§Ø±ÙŠ</option>
                    <option value="Ø­ÙƒÙˆÙ…Ù‰">Ø­ÙƒÙˆÙ…ÙŠ</option>
                    <option value="VIP">VIP</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="propertyCondition" class="required">Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±</label>
                <select id="propertyCondition">
                    <option value="Ø¹Ù‚Ø§Ø± Ù‚Ø§Ø¦Ù…">Ø¹Ù‚Ø§Ø± Ù‚Ø§Ø¦Ù…</option>
                    <option value="Ø§Ø±Ø¶ ÙØ¶Ø§Ø¡">Ø£Ø±Ø¶ ÙØ¶Ø§Ø¡</option>
                    <option value="Ø¹Ù‚Ø§Ø± Ù…Ù‡Ø¯ÙˆÙ…">Ø¹Ù‚Ø§Ø± Ù…Ù‡Ø¯ÙˆÙ…</option>
                    <option value="Ø¹Ù‚Ø§Ø± ØªØ­Øª Ø§Ù„Ø§Ù†Ø´Ø§Ø¡">Ø¹Ù‚Ø§Ø± ØªØ­Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="hasViolation" class="required">ÙŠÙˆØ¬Ø¯ ØªØ¹Ø¯ÙŠ</label>
                <select id="hasViolation">
                    <option value="Ù„Ø§">Ù„Ø§</option>
                    <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="districtName" class="required">Ø§Ø³Ù… Ø§Ù„Ø­ÙŠ</label>
                <input type="text" id="districtName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø­ÙŠ/Ø§Ù„Ù…Ù†Ø·Ù‚Ø©" value="Ø­ÙŠ Ø§Ù„Ù†Ø®ÙŠÙ„">
            </div>
            
            <div class="form-group">
                <label for="electricityMetersCount" class="required">Ø¹Ø¯Ø¯ Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡</label>
                <input type="number" id="electricityMetersCount" min="1" value="2">
            </div>
        </div>
        
        <!-- Ù‚Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ -->
        <div class="form-section">
            <h2>Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</h2>
            
            <div class="form-group">
                <label for="latitude" class="required">Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶ (Latitude)</label>
                <input type="text" id="latitude" value="24.7136" readonly>
            </div>
            
            <div class="form-group">
                <label for="longitude" class="required">Ø®Ø· Ø§Ù„Ø·ÙˆÙ„ (Longitude)</label>
                <input type="text" id="longitude" value="46.6753" readonly>
            </div>
            
            <button class="btn btn-info" onclick="getLocation()">
                ğŸ“ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
            </button>
        </div>
        
        <!-- Ù‚Ø³Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙ†ÙŠ -->
        <div class="form-section">
            <h2>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙ†ÙŠ</h2>
            
            <div class="form-group">
                <label for="technicianName" class="required">Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ</label>
                <input type="text" id="technicianName" placeholder="Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„" value="Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯">
            </div>
        </div>

        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="form-section">
            <h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
            
            <div class="btn-group">
                <button class="btn btn-success" onclick="submitFullData()">
                    ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©
                </button>
                
                <button class="btn btn-info" onclick="testConnection()">
                    ğŸ”— Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„
                </button>
                
                <button class="btn btn-warning" onclick="submitTestData()">
                    ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹
                </button>
                
                <button class="btn btn-danger" onclick="clearForm()">
                    ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                </button>
            </div>
        </div>

        <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… -->
        <div id="message"></div>
        
        <!-- ÙˆØ­Ø¯Ø© ØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ -->
        <div id="debugConsole">
            <div class="debug-header">
                <span>ğŸ”§ ÙˆØ­Ø¯Ø© ØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ - Ø§Ù„Ù†Ø¸Ø§Ù…</span>
                <div class="debug-controls">
                    <button class="debug-btn" onclick="toggleDebug()">Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡</button>
                    <button class="debug-btn" onclick="clearDebug()">Ù…Ø³Ø­</button>
                </div>
            </div>
            <div>ğŸš€ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…...</div>
        </div>
    </div>

    <script>
        // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù€ Google Apps Script
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxCYWSdf2AUQLGguEXEwsCoKWIr60Ohud22KSxbl3qrAdj0BQ9H9JsjbqFTgNCil7AgAw/exec';

        let debugVisible = true;

        function debugLog(message, type = 'info') {
            const console = document.getElementById('debugConsole');
            if (!debugVisible) return;
            
            const time = new Date().toLocaleTimeString();
            const icon = type === 'error' ? 'âŒ' : type === 'success' ? 'âœ…' : 'â„¹ï¸';
            console.innerHTML += `<div>${icon} ${time}: ${message}</div>`;
            console.scrollTop = console.scrollHeight;
        }

        function showMessage(message, type = 'info') {
            const messageDiv = document.getElementById('message');
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : 'message';
            messageDiv.innerHTML = `<div class="${className}">${message}</div>`;
        }

        function clearDebug() {
            const console = document.getElementById('debugConsole');
            console.innerHTML = '<div class="debug-header"><span>ğŸ”§ ÙˆØ­Ø¯Ø© ØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ - Ø§Ù„Ù†Ø¸Ø§Ù…</span><div class="debug-controls"><button class="debug-btn" onclick="toggleDebug()">Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡</button><button class="debug-btn" onclick="clearDebug()">Ù…Ø³Ø­</button></div></div><div>ğŸ—‘ï¸ ØªÙ… Ù…Ø³Ø­ Ø³Ø¬Ù„ Ø§Ù„ØªØµØ­ÙŠØ­...</div>';
        }

        function toggleDebug() {
            debugVisible = !debugVisible;
            const console = document.getElementById('debugConsole');
            console.style.display = debugVisible ? 'block' : 'none';
        }

        function getLocation() {
            debugLog('ğŸ“ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹...');
            
            if (!navigator.geolocation) {
                showMessage('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø®Ø¯Ù…
                                    function getLocation() {
            debugLog('ğŸ“ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹...');
            
            if (!navigator.geolocation) {
                showMessage('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹', 'error');
                return;
            }
            
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    const lat = position.coords.latitude.toFixed(6);
                    const lng = position.coords.longitude.toFixed(6);
                    
                    document.getElementById('latitude').value = lat;
                    document.getElementById('longitude').value = lng;
                    
                    debugLog(`âœ… ØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${lat}, ${lng}`);
                    showMessage(`ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${lat}, ${lng}`, 'success');
                },
                function(error) {
                    let errorMsg = 'ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ';
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMsg += 'ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¥Ø°Ù†';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMsg += 'Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…ØªØ§Ø­';
                            break;
                        case error.TIMEOUT:
                            errorMsg += 'Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ù‡Ù„Ø©';
                            break;
                        default:
                            errorMsg += 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                    }
                    debugLog(`âŒ ${errorMsg}`);
                    showMessage(errorMsg, 'error');
                },
                {
                    enableHighAccuracy: true,
                    timeout: 15000,
                    maximumAge: 0
                }
            );
        }

        async function testConnection() {
            debugLog('ğŸ”— Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø©...');
            showMessage('Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„...', 'info');
            
            try {
                const startTime = Date.now();
                const response = await fetch(SCRIPT_URL);
                const endTime = Date.now();
                const result = await response.json();
                
                const responseTime = endTime - startTime;
                debugLog(`âœ… Ø§Ù„Ø§ØªØµØ§Ù„ Ù†Ø§Ø¬Ø­: ${result.message}`);
                debugLog(`âš¡ Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: ${responseTime}ms`);
                debugLog(`ğŸ“Š Ø§Ù„Ø¥ØµØ¯Ø§Ø±: ${result.version}`);
                debugLog(`ğŸ› ï¸ Ø§Ù„Ù…ÙŠØ²Ø§Øª: ${result.features.join(', ')}`);
                
                showMessage(`âœ… ${result.message} - Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: ${responseTime}ms`, 'success');
                
            } catch (error) {
                debugLog(`âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„: ${error.message}`);
                showMessage(`âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„: ${error.message}`, 'error');
            }
        }

        async function submitFullData() {
            debugLog('ğŸ“¤ Ø¨Ø¯Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©...');
            showMessage('Ø¬Ø§Ø±ÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...', 'info');
            
            const formData = {
                meterNumber: document.getElementById('meterNumber').value,
                meterType: document.getElementById('meterType').value,
                meterBrand: document.getElementById('meterBrand').value,
                valveType: document.getElementById('valveType').value,
                valveCondition: document.getElementById('valveCondition').value,
                boxCondition: document.getElementById('boxCondition').value,
                pieceNumber: document.getElementById('pieceNumber').value,
                propertyType: document.getElementById('propertyType').value,
                propertyCondition: document.getElementById('propertyCondition').value,
                hasViolation: document.getElementById('hasViolation').value,
                districtName: document.getElementById('districtName').value,
                electricityMetersCount: document.getElementById('electricityMetersCount').value,
                latitude: document.getElementById('latitude').value,
                longitude: document.getElementById('longitude').value,
                technicianName: document.getElementById('technicianName').value,
                timestamp: new Date().toISOString()
            };

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            const requiredFields = ['meterNumber', 'meterType', 'technicianName'];
            for (const field of requiredFields) {
                if (!formData[field]) {
                    const fieldName = document.querySelector(`[id="${field}"]`).previousElementSibling.textContent;
                    showMessage(`âŒ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø­Ù‚Ù„ ${fieldName}`, 'error');
                    return;
                }
            }

            debugLog(`ğŸ“ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©: ${JSON.stringify(formData, null, 2)}`);

            try {
                const startTime = Date.now();
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                const endTime = Date.now();

                debugLog(`ğŸ“¨ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: ${response.status} - ${response.statusText}`);
                debugLog(`âš¡ ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: ${endTime - startTime}ms`);
                
                if (!response.ok) {
                    throw new Error(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: ${response.status}`);
                }
                
                const result = await response.json();
                debugLog(`ğŸ“Š Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø®Ø§Ø¯Ù…: ${JSON.stringify(result, null, 2)}`);

                if (result.success) {
                    showMessage(`âœ… ${result.message}`, 'success');
                    debugLog('ğŸ‰ ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­ ÙÙŠ Google Sheets!');
                    // ØªØ­Ø¯ÙŠØ« Ø±Ù‚Ù… Ø§Ù„Ø¹Ø¯Ø§Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ§Ù„ÙŠ
                    document.getElementById('meterNumber').value = 'TEST-' + Date.now();
                } else {
                    showMessage(`âŒ ${result.error}`, 'error');
                    debugLog('ğŸ’¥ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø­ÙØ¸: ' + result.error);
                }

            } catch (error) {
                debugLog(`ğŸ’¥ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ${error.message}`);
                showMessage(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ${error.message}`, 'error');
            }
        }

        async function submitTestData() {
            debugLog('ğŸ§ª Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹...');
            
            const testData = {
                meterNumber: 'TEST-' + Date.now(),
                meterType: 'Ø°ÙƒÙ‰',
                meterBrand: 'Ù‡ÙŠØ¯Ø±ÙˆØ³',
                valveType: 'Ø¨ÙˆÙ‚Ø§ØªÙ‰',
                valveCondition: 'Ø³Ù„ÙŠÙ…',
                boxCondition: 'Ø³Ù„ÙŠÙ…',
                pieceNumber: 'TEST-PIECE',
                propertyType: 'Ø³ÙƒÙ†Ù‰',
                propertyCondition: 'Ø¹Ù‚Ø§Ø± Ù‚Ø§Ø¦Ù…',
                hasViolation: 'Ù„Ø§',
                districtName: 'Ø§Ù„Ø­ÙŠ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ',
                electricityMetersCount: '1',
                latitude: '24.7136',
                longitude: '46.6753',
                technicianName: 'ÙÙ†ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±',
                timestamp: new Date().toISOString()
            };
            
            debugLog(`ğŸ“ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${JSON.stringify(testData)}`);
            
            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(testData)
                });
                
                const result = await response.json();
                debugLog(`ğŸ“Š Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${JSON.stringify(result, null, 2)}`);
                
                if (result.success) {
                    showMessage(`âœ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø§Ø¬Ø­: ${result.message}`, 'success');
                    document.getElementById('meterNumber').value = testData.meterNumber;
                } else {
                    showMessage(`âŒ ÙØ´Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${result.error}`, 'error');
                }
                
            } catch (error) {
                debugLog(`ğŸ’¥ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${error.message}`);
                showMessage(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${error.message}`, 'error');
            }
        }

        function clearForm() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
                const inputs = document.querySelectorAll('input, select');
                inputs.forEach(input => {
                    if (input.type !== 'button' && input.id !== 'latitude' && input.id !== 'longitude') {
                        input.value = '';
                    }
                });
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                document.getElementById('meterNumber').value = 'TEST-001';
                document.getElementById('meterType').value = 'Ø°ÙƒÙ‰';
                document.getElementById('meterBrand').value = 'Ù‡ÙŠØ¯Ø±ÙˆØ³';
                document.getElementById('valveType').value = 'Ø¨ÙˆÙ‚Ø§ØªÙ‰';
                document.getElementById('valveCondition').value = 'Ø³Ù„ÙŠÙ…';
                document.getElementById('boxCondition').value = 'Ø³Ù„ÙŠÙ…';
                document.getElementById('pieceNumber').value = 'Ù‚Ø·Ø¹Ø©-2024';
                document.getElementById('propertyType').value = 'Ø³ÙƒÙ†Ù‰';
                document.getElementById('propertyCondition').value = 'Ø¹Ù‚Ø§Ø± Ù‚Ø§Ø¦Ù…';
                document.getElementById('hasViolation').value = 'Ù„Ø§';
                document.getElementById('districtName').value = 'Ø­ÙŠ Ø§Ù„Ù†Ø®ÙŠÙ„';
                document.getElementById('electricityMetersCount').value = '2';
                document.getElementById('technicianName').value = 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯';
                
                debugLog('ğŸ—‘ï¸ ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†');
                showMessage('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        window.onload = function() {
            debugLog('ğŸš€ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­');
            debugLog('ğŸ“ Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø¯Ù…Ø©: ' + SCRIPT_URL);
            debugLog('ğŸ’» Ø§Ù„Ù…ØªØµÙØ­: ' + navigator.userAgent);
            
            // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
            setTimeout(() => {
                testConnection();
            }, 2000);
        };

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø­Ù‚ÙˆÙ„
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = document.querySelectorAll('input, select');
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.style.borderColor = '#3498db';
                    this.style.backgroundColor = '#f8f9fa';
                });
                
                input.addEventListener('blur', function() {
                    this.style.borderColor = '#ddd';
                    this.style.backgroundColor = 'white';
                });
            });
        });
    </script>
</body>
</html>
